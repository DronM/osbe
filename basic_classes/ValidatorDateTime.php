<?phprequire_once(FRAME_WORK_PATH.'basic_classes/Validator.php');class ValidatorDateTime extends Validator {	public function validate($val){			$val = trim($val);				$l = strtolower($val);		if (!$val || !strlen($val) || $l=='undefined' || $l=='null'){			return 'null';		}					$DATE_SEPARATOR = '.';		$TIME_SEPARATOR = ':';		$MSEC_SEPARATOR = '.';				$cor_val = $val;		$cor_val = preg_replace('/\//',$DATE_SEPARATOR,$cor_val);		$cor_val = preg_replace('/-/',$DATE_SEPARATOR,$cor_val);		$cor_val = preg_replace('/_/','',$cor_val);		$cor_val = preg_replace('/T/',' ',$cor_val);				$pos = strpos($cor_val,' ');		if ($pos===FALSE){			$part_time = '00:00';			$part_date = $cor_val;		}		else{			$part_time = substr($cor_val,$pos);			$part_date = substr($cor_val,0,$pos);		}				$date_parts = explode($DATE_SEPARATOR,$part_date);		if (count($date_parts)<3){			throw new Exception(sprintf(Validator::ER_INVALID_VALUE,'Дата-время'));		}		if (strlen($date_parts[0])==4){			list($y,$m,$d) = $date_parts;		}		else{			list($d,$m,$y) = $date_parts;		}		$m = intval($m);		$d = intval($d);		$y = intval($y);				if (strlen($part_date)==8){			//short year						$y+=2000;		}				if (sizeof($date_parts) == 3			&& checkdate($m,$d,$y)){		}		else{						throw new Exception(sprintf(Validator::ER_INVALID_VALUE,'Дата-время'));		}				$time_parts = explode($TIME_SEPARATOR,$part_time);		$h = 0;		$min = 0;		$sec = 0;		$msec = 0;						if (sizeof($time_parts)>=1){			$h = intval($time_parts[0]);		}		if (sizeof($time_parts)>=2){			$min = intval($time_parts[1]);		}		if (sizeof($time_parts)>=3){			$sec_parts = explode($MSEC_SEPARATOR,$time_parts[2]);			if (sizeof($sec_parts)>=1){				$sec = intval($sec_parts[0]);			}			if (sizeof($sec_parts)>=2){				$msec = intval($sec_parts[1]);			}					}				//echo 'ValidatorDateTime='.$part_date.' '.$part_time;		//' DT='.$d.$DATE_SEPARATOR.$m.$DATE_SEPARATOR.$y.' '.$h.':'.$min.':'.$sec.'='		//throw new Exception(strtotime($d.$DATE_SEPARATOR.$m.$DATE_SEPARATOR.$y.' '.$h.':'.$min.':'.$sec));		//.'.'.$msec		return strtotime($d.$DATE_SEPARATOR.$m.$DATE_SEPARATOR.$y.' '.$h.':'.$min.':'.$sec);	}	}?>